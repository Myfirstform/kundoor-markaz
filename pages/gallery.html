<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keywords" content="kundoor markaz, markaz kundoor, gallery, photos, campus">
    <meta name="description" content="Gallery of Kundoor Markaz - View photos and moments from our campus life.">
    <link rel="icon" href="../pics/markaz web icon.png" type="image/x-icon">
    
    <title>Gallery | Kundoor Markaz</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Open+Sans:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css">
    <link rel="stylesheet" href="../modern-style.css">
    <link rel="stylesheet" href="../modern-components.css">
    <style>
        body {
            overflow-x: hidden;
            margin: 0;
            padding: 0;
        }
        
        /* Iframe Wrapper */
        #gallery-iframe-wrapper {
            width: 100%;
            overflow: hidden;
            margin: 0;
            padding: 0;
            background: #fff;
        }
        
        /* Iframe Styling */
        #galleryIframe {
            width: 100%;
            border: none;
            padding: 0;
            margin: 0;
            display: block;
            background: #fff;
            min-height: 100vh;
        }
        
        /* Ensure no scrollbars */
        html, body {
            overflow-x: hidden;
        }
        
        /* Smooth height transitions */
        #galleryIframe {
            transition: height 0.3s ease-out;
        }
    </style>
</head>
<body>
    
    <!-- HEADER -->
    <header class="header">
        <div class="header-container">
            <a href="../index.html">
                <img src="../pics/logo 66666.png" alt="Kundoor Markaz Logo" class="logo">
            </a>
            
            <nav>
                <ul class="nav-menu">
                    <li><a href="../index.html" class="nav-link">Home</a></li>
                    <li><a href="./admission.html" class="nav-link">Admission</a></li>
                    <li><a href="./gallery.html" class="nav-link">Gallery</a></li>
                    <li><a href="./publication.html" class="nav-link">Publication</a></li>
                    <li><a href="./contact.html" class="nav-link">Contact</a></li>
                    
                    <div class="header-social">
                        <a href="https://www.instagram.com/thasqeef_media/" class="social-icon"><i class="fab fa-instagram"></i></a>
                        <a href="https://www.youtube.com/@Kundoor_Markaz" class="social-icon"><i class="fab fa-youtube"></i></a>
                        <a href="https://www.facebook.com/thasqeefmedia" class="social-icon"><i class="fab fa-facebook"></i></a>
                        <a href="https://wa.me/919746675758" class="social-icon"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </ul>
            </nav>
            
            <button class="menu-toggle">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </header>
    
    <!-- PAGE HEADER -->
    <div class="page-header">
        <div class="container">
            <h1 data-aos="fade-up">Gallery</h1>
            <p data-aos="fade-up" data-aos-delay="100">Moments from our campus</p>
        </div>
    </div>
    
    <!-- BREADCRUMBS -->
    <div class="breadcrumbs">
        <div class="container">
            <ul class="breadcrumbs-list">
                <li class="breadcrumb-item"><a href="../index.html">Home</a></li>
                <li class="breadcrumb-separator">/</li>
                <li class="breadcrumb-item">Gallery</li>
            </ul>
        </div>
    </div>
    
    <!-- GALLERY IFRAME SECTION -->
    <section id="gallery-iframe-section" style="margin: 0; padding: 0; width: 100%;
        background: #fff; /* Ensure consistent background */
        overflow: hidden; /* Prevent any potential scrollbars */
    ">
        <iframe
            id="lovableGalleryIframe"
            src="https://preview--image-book-cms.lovable.app"
            style="
                width: 100%;
                border: none;
                margin: 0;
                padding: 0;
                overflow: hidden;
                display: block;
                transition: height 300ms ease;
            "
            scrolling="no"
            aria-hidden="false"
            title="Kundoor Markaz Gallery"
            loading="eager">
        </iframe>
    </section>
    
    <script>
    /*
     Robust iframe resize handler for Lovable-embedded pages.
     
     Behaviour:
      - Accepts messages of shape: { type: "resize", height: NUMBER, modalOpen?: boolean }
      - If modalOpen === true -> ignore large height increase (do not expand iframe)
      - Otherwise use heuristics to avoid reacting to very short spikes:
         - Debounce incoming heights (200ms)
         - If newHeight - lastStableHeight > SPIKE_THRESHOLD -> treat as spike and ignore
         - If the increase persists for more than SPREAD_TIME (e.g., 800ms) then accept it
      - Smooth CSS transition for visual comfort.
    */
    
    (function () {
      const iframe = document.getElementById("lovableGalleryIframe");
      if (!iframe) return;
    
      const SPIKE_THRESHOLD = 300; // px; increases larger than this in one update look suspicious
      const PERSIST_MS = 800;      // if the big height stays this long, accept it
      const DEBOUNCE_MS = 200;     // debounce postMessage events
      let lastStableHeight = iframe.clientHeight || 600; // initial fallback
      let lastRequestedHeight = lastStableHeight;
      let spikeTimer = null;
      let debounceTimer = null;
    
      // Helper to set iframe height safely
      function applyHeight(h) {
        // ensure a minimum
        const minH = 200;
        const finalH = Math.max(h, minH);
        iframe.style.height = finalH + "px";
        lastStableHeight = finalH;
      }
    
      // Called when we see a candidate height from the iframe
      function handleCandidateHeight(candidate, meta = {}) {
        // If Lovable explicitly tells modal is open, ignore large increases
        if (meta.modalOpen === true) {
          // If modal opens, keep the iframe at lastStableHeight (do not expand)
          return;
        }
    
        // simple case: small changes -> accept
        const diff = candidate - lastStableHeight;
        if (Math.abs(diff) <= SPIKE_THRESHOLD) {
          // clear any pending spike timers
          if (spikeTimer) { clearTimeout(spikeTimer); spikeTimer = null; }
          applyHeight(candidate);
          return;
        }
    
        // Large increase (possible modal). Start a persistence timer:
        lastRequestedHeight = candidate;
        if (spikeTimer) clearTimeout(spikeTimer);
    
        spikeTimer = setTimeout(() => {
          // If the large height remains after PERSIST_MS, accept it as real change
          applyHeight(lastRequestedHeight);
          spikeTimer = null;
        }, PERSIST_MS);
      }
    
      // Debounced message handler
      function onMessageDebounced(event) {
        // IMPORTANT: For security you may want to check event.origin here
        if (!event.data || event.data.type !== "resize") return;
        const height = parseInt(event.data.height, 10);
        if (isNaN(height)) return;
    
        // If Lovable includes explicit modal flag, pass it through
        handleCandidateHeight(height, { modalOpen: !!event.data.modalOpen });
      }
    
      // Debounce wrapper
      function onMessage(event) {
        if (debounceTimer) clearTimeout(debounceTimer);
        debounceTimer = setTimeout(() => onMessageDebounced(event), DEBOUNCE_MS);
      }
    
      window.addEventListener("message", onMessage, false);
    
      // On initial load, request a size ping from iframe (if Lovable supports it)
      // and set a safe default height while waiting.
      applyHeight(lastStableHeight);
    
      // Handle window resize to ensure proper sizing
      function handleResize() {
        const newHeight = window.innerHeight;
        if (Math.abs(newHeight - lastStableHeight) > 50) { // Only adjust for significant changes
          applyHeight(newHeight);
        }
      }
      
      // Add debounced resize handler
      let resizeTimer;
      window.addEventListener('resize', function() {
        clearTimeout(resizeTimer);
        resizeTimer = setTimeout(handleResize, 100);
      });
      
      // Initial resize check
      handleResize();
    })();
    </script>
        </div>
    </section>
    
    <!-- FOOTER -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Kundoor Markaz</h3>
                    <p>A premier Islamic educational institution dedicated to excellence in both religious and modern education.</p>
                    <div class="footer-social">
                        <a href="https://www.instagram.com/thasqeef_media/" class="footer-social-icon"><i class="fab fa-instagram"></i></a>
                        <a href="https://www.youtube.com/@Kundoor_Markaz" class="footer-social-icon"><i class="fab fa-youtube"></i></a>
                        <a href="https://www.facebook.com/thasqeefmedia" class="footer-social-icon"><i class="fab fa-facebook"></i></a>
                        <a href="https://wa.me/919746675758" class="footer-social-icon"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </div>
                
                <div class="footer-section">
                    <h3>Quick Links</h3>
                    <div class="footer-links">
                        <a href="./about.html" class="footer-link">About Us</a>
                        <a href="./admission.html" class="footer-link">Admissions</a>
                        <a href="./gallery.html" class="footer-link">Gallery</a>
                        <a href="./publication.html" class="footer-link">Publications</a>
                    </div>
                </div>
                
                <div class="footer-section">
                    <h3>Contact</h3>
                    <p>2W6C+2WV, Kundoor, Nannambra<br>Malappuram, Kerala 676508</p>
                    <p>Email: thasqeefmedia@gmail.com<br>Phone: +91 97466 75758</p>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2024 Markazu Ssaqafathil Islamiyya Kundoor. All rights reserved.</p>
            </div>
        </div>
    </footer>
    
    <!-- SCROLL TO TOP -->
    <button class="scroll-to-top">
        <i class="fas fa-arrow-up"></i>
    </button>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
    <script>AOS.init({ duration: 1000, once: true });</script>
    <script>
        // Auto-resize iframe based on content
        window.addEventListener("message", (event) => {
            if (event.data?.type === "resize") {
                const iframe = document.getElementById("lovableGalleryIframe");
                if (iframe) {
                    iframe.style.height = event.data.height + "px";
                }
            }
        });
    </script>
    <script src="../modern-script.js"></script>
</body>
</html>
